<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>樑仔实践学习笔记</title>
  <icon>https://www.gravatar.com/avatar/cd27e3a3f93e5aa7d1057deec02b729f</icon>
  <subtitle>天行健，君子于自强不息</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://code.cookily.cn/"/>
  <updated>2018-02-26T08:10:09.467Z</updated>
  <id>http://code.cookily.cn/</id>
  
  <author>
    <name>樑仔</name>
    <email>cookily@vip.qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql 用户创建+密码修改+删除用户+角色分配</title>
    <link href="http://code.cookily.cn/2018/02/26/ghfghfgh/"/>
    <id>http://code.cookily.cn/2018/02/26/ghfghfgh/</id>
    <published>2018-02-26T08:10:09.466Z</published>
    <updated>2018-02-26T08:10:09.467Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">当前mysql版本</span><br><span class="line">mysql&gt; select version();</span><br><span class="line">+------------+</span><br><span class="line">| version()  |</span><br><span class="line">+------------+</span><br><span class="line">| 5.6.38 |</span><br><span class="line">+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="1-创建用户"><a href="#1-创建用户" class="headerlink" title="1.创建用户:"></a>1.创建用户:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &apos;username&apos;@&apos;host&apos; IDENTIFIED BY &apos;password&apos;;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username：你将创建的用户名</span><br><span class="line">host：指定该用户在哪个主机上可以登陆，如果是本地用户可用localhost，如果想让该用户可以从任意远程主机登陆，可以使用通配符%</span><br><span class="line">password：该用户的登陆密码，密码可以为空，如果为空则该用户可以不需要密码登陆服务器</span><br></pre></td></tr></table></figure><p><strong>举个栗子:</strong><br><strong>创建张三用户，密码123456，可以从任意远程主机登陆(%)</strong><br><strong>如果是本地用户可用(localhost)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &apos;zhangsan&apos;@&apos;%&apos; IDENTIFIED BY &apos;123456&apos;;</span><br></pre></td></tr></table></figure></p><hr><h2 id="2-授权"><a href="#2-授权" class="headerlink" title="2. 授权:"></a>2. 授权:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT privileges ON databasename.tablename TO &apos;username&apos;@&apos;host&apos;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">privileges：用户的操作权限，如SELECT，INSERT，UPDATE等，如果要授予所的权限则使用ALL</span><br><span class="line">databasename：数据库名</span><br><span class="line">tablename：表名，如果要授予该用户对所有数据库和表的相应操作权限则可用*表示，如*.*</span><br></pre></td></tr></table></figure><p><strong>举个栗子:</strong><br><strong>给予zhangsan用户,在任意远程主机对bilibili库的a表select和insert权限</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT, INSERT ON bilibili.a TO &apos;zhangsan&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure></p><p><strong>给予zhangsan用户,在任意远程主机所有库所有权限</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL ON *.* TO &apos;zhangsan&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure></p><p><strong>如果授予权限要传递，那就在屁股跟上WITH GRANT OPTION;</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL ON *.* TO &apos;zhangsan&apos;@&apos;%&apos; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure><h2 id="3-设置与更改用户密码"><a href="#3-设置与更改用户密码" class="headerlink" title="3.设置与更改用户密码"></a>3.设置与更改用户密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD FOR &apos;username&apos;@&apos;host&apos; = PASSWORD(&apos;newpassword&apos;);</span><br></pre></td></tr></table></figure><p><strong>如果是当前登陆用户用也可以使用：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD = PASSWORD(&quot;newpassword&quot;);</span><br></pre></td></tr></table></figure></p><h2 id="4-撤销用户权限"><a href="#4-撤销用户权限" class="headerlink" title="4. 撤销用户权限"></a>4. 撤销用户权限</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE privilege ON databasename.tablename FROM &apos;username&apos;@&apos;host&apos;;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">privileges：用户的操作权限，如SELECT，INSERT，UPDATE等，如果要授予所的权限则使用ALL</span><br><span class="line">databasename：数据库名</span><br><span class="line">tablename：表名，如果要授予该用户对所有数据库和表的相应操作权限则可用*表示，如*.*</span><br></pre></td></tr></table></figure><p><strong>举个栗子:</strong><br><strong>取消zhangsan对bilibili库的a表select权限</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE SELECT ON bilibili.a FROM &apos;zhangsan&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure><p><strong>假如你在给用户‘zhangsan‘@’%’授权的时候是这样的（或类似的）：GRANT SELECT ON bilibili.a TO ‘zhangsan‘@’%’</strong><br><strong>则在使用REVOKE SELECT ON <em>.</em> FROM ‘zhangsan‘@’%’;命令并不能撤销该用户对test数据库中user表的SELECT 操作。</strong><br><strong>相反，如果授权使用的是GRANT SELECT ON <em>.</em> TO ‘zhangsan‘@’%’;则REVOKE SELECT ON bilibili.a FROM ‘zhangsan‘@’%’;命令也不能撤销该用户对test数据库中user表的Select权限。</strong><br><strong>具体信息可以用命令SHOW GRANTS FOR ‘zhangsan‘@’%’; 查看。</strong></p><h2 id="5-然后删除用户"><a href="#5-然后删除用户" class="headerlink" title="5.然后删除用户"></a>5.然后删除用户</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER &apos;username&apos;@&apos;host&apos;;</span><br></pre></td></tr></table></figure><p><strong>举个栗子:</strong><br><strong>删除zhangsan用户</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER &apos;zhangsan&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
      <category term="mysql" scheme="http://code.cookily.cn/categories/mysql/"/>
    
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="mysql" scheme="http://code.cookily.cn/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 安装最新 Docker 并实现阿里云加速 网易加速</title>
    <link href="http://code.cookily.cn/2018/02/26/fghhsdhf/"/>
    <id>http://code.cookily.cn/2018/02/26/fghhsdhf/</id>
    <published>2018-02-26T08:06:05.010Z</published>
    <updated>2018-02-26T08:06:05.010Z</updated>
    
    <content type="html"><![CDATA[<p><strong>系统:Centos 7 64bit</strong><br><strong>直接用yum install docker -y安装的docker版本为1.12，但是docker发展很快，现在都17.12.0了。docker-ce是指docker的社区版</strong></p><h2 id="1-首先卸载旧版本docker及相关依赖"><a href="#1-首先卸载旧版本docker及相关依赖" class="headerlink" title="1.首先卸载旧版本docker及相关依赖"></a>1.首先卸载旧版本docker及相关依赖</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker docker-common container-selinux docker-selinux docker-engine</span><br></pre></td></tr></table></figure><h2 id="2-安装-yum-utils，它提供了-yum-config-manager，可用来管理yum源"><a href="#2-安装-yum-utils，它提供了-yum-config-manager，可用来管理yum源" class="headerlink" title="2.安装 yum-utils，它提供了 yum-config-manager，可用来管理yum源"></a>2.安装 yum-utils，它提供了 yum-config-manager，可用来管理yum源</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils</span><br></pre></td></tr></table></figure><h2 id="3-添加yum源"><a href="#3-添加yum源" class="headerlink" title="3.添加yum源"></a>3.添加yum源</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><h2 id="4-更新yum索引"><a href="#4-更新yum索引" class="headerlink" title="4.更新yum索引"></a>4.更新yum索引</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure><h2 id="5-安装-docker-ce"><a href="#5-安装-docker-ce" class="headerlink" title="5.安装 docker-ce"></a>5.安装 docker-ce</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce</span><br></pre></td></tr></table></figure><h2 id="6-启动-docker"><a href="#6-启动-docker" class="headerlink" title="6.启动 docker"></a>6.启动 docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><h2 id="7-验证是否安装成功"><a href="#7-验证是否安装成功" class="headerlink" title="7.验证是否安装成功"></a>7.验证是否安装成功</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><h2 id="8-阿里云加速"><a href="#8-阿里云加速" class="headerlink" title="8.阿里云加速"></a>8.阿里云加速</h2><p><strong>8.1首先注册开通阿里云开发者帐号</strong><br><strong><a href="https://dev.aliyun.com/search.html" target="_blank" rel="noopener">注册开通阿里云开发者</a></strong></p><p><strong>8.2登录后在个人中心点击加速器，同时会给出加速器地址。</strong></p><p><strong>8.3选择对应的系统并根据自己的docker版本执行相应的步骤；</strong></p><p><strong>8.4Docker客户端版本大于1.10的用户 可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://1jdvuba1.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="9-网易加速"><a href="#9-网易加速" class="headerlink" title="9.网易加速"></a>9.网易加速</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><h2 id="阿里云提供的安装方式"><a href="#阿里云提供的安装方式" class="headerlink" title="阿里云提供的安装方式"></a>阿里云提供的安装方式</h2><p><strong>step 1: 安装必要的一些系统工具</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure><p><strong>Step 2: 添加软件源信息</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><p><strong>Step 3: 更新并安装 Docker-CE</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum -y install docker-ce</span><br></pre></td></tr></table></figure><p><strong>Step 4: 开启Docker服务</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker start</span><br></pre></td></tr></table></figure><p><strong>Step 5: 查看Docker版本</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br><span class="line"></span><br><span class="line">Client:</span><br><span class="line"> Version:17.12.0-ce</span><br><span class="line"> API version:1.35</span><br><span class="line"> Go version:go1.9.2</span><br><span class="line"> Git commit:c97c6d6</span><br><span class="line"> Built:Wed Dec 27 20:10:14 2017</span><br><span class="line"> OS/Arch:linux/amd64</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Engine:</span><br><span class="line">  Version:17.12.0-ce</span><br><span class="line">  API version:1.35 (minimum version 1.12)</span><br><span class="line">  Go version:go1.9.2</span><br><span class="line">  Git commit:c97c6d6</span><br><span class="line">  Built:Wed Dec 27 20:12:46 2017</span><br><span class="line">  OS/Arch:linux/amd64</span><br><span class="line">  Experimental:false</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;系统:Centos 7 64bit&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;直接用yum install docker -y安装的docker版本为1.12，但是docker发展很快，现在都17.12.0了。docker-ce是指docker的社区版&lt;/st
      
    
    </summary>
    
      <category term="Docker" scheme="http://code.cookily.cn/categories/Docker/"/>
    
      <category term="阿里云加速" scheme="http://code.cookily.cn/categories/Docker/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F/"/>
    
      <category term="网易加速" scheme="http://code.cookily.cn/categories/Docker/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F/%E7%BD%91%E6%98%93%E5%8A%A0%E9%80%9F/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Docker/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F/%E7%BD%91%E6%98%93%E5%8A%A0%E9%80%9F/Centos-7/"/>
    
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Docker，Centos 7" scheme="http://code.cookily.cn/tags/Docker%EF%BC%8CCentos-7/"/>
    
      <category term="阿里云加速" scheme="http://code.cookily.cn/tags/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F/"/>
    
      <category term="网易加速" scheme="http://code.cookily.cn/tags/%E7%BD%91%E6%98%93%E5%8A%A0%E9%80%9F/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 下 docker 安装MySQL 和使用 内部连接和外部连接</title>
    <link href="http://code.cookily.cn/2018/02/26/qw/"/>
    <id>http://code.cookily.cn/2018/02/26/qw/</id>
    <published>2018-02-26T08:01:25.610Z</published>
    <updated>2018-02-26T08:01:25.610Z</updated>
    
    <content type="html"><![CDATA[<p><strong>参考：<a href="https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.79825aaaVNcsUP&amp;repoId=1239" target="_blank" rel="noopener">阿里mysql docker 文档</a></strong></p><h2 id="1-首先查看下仓库镜像"><a href="#1-首先查看下仓库镜像" class="headerlink" title="1.首先查看下仓库镜像"></a>1.首先查看下仓库镜像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search mysql</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker search mysql</span><br><span class="line">NAME                                                   DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">mysql                                                  MySQL is a widely used, open-source relation…   5676                [OK]                </span><br><span class="line">mariadb                                                MariaDB is a community-developed fork of MyS…   1760                [OK]                </span><br><span class="line">mysql/mysql-server                                     Optimized MySQL Server Docker images. Create…   390                                     [OK]</span><br><span class="line">zabbix/zabbix-server-mysql                             Zabbix Server with MySQL database support       78                                      [OK]</span><br><span class="line">hypriot/rpi-mysql                                      RPi-compatible Docker Image with Mysql          78                                      </span><br><span class="line">centurylink/mysql                                      Image containing mysql. Optimized to be link…   58                                      [OK]</span><br><span class="line">zabbix/zabbix-web-nginx-mysql                          Zabbix frontend based on Nginx web-server wi…   41                                      [OK]</span><br><span class="line">tutum/mysql                                            Base docker image to run a MySQL database se…   31                                      </span><br><span class="line">1and1internet/ubuntu-16-nginx-php-phpmyadmin-mysql-5   ubuntu-16-nginx-php-phpmyadmin-mysql-5          25                                      [OK]</span><br><span class="line">mysql/mysql-cluster                                    Experimental MySQL Cluster Docker images. Cr…   19                                      </span><br><span class="line">centos/mysql-57-centos7                                MySQL 5.7 SQL database server                   17                                      </span><br><span class="line">schickling/mysql-backup-s3                             Backup MySQL to S3 (supports periodic backup…   16                                      [OK]</span><br><span class="line">linuxserver/mysql                                      A Mysql container, brought to you by LinuxSe…   14                                      </span><br><span class="line">zabbix/zabbix-proxy-mysql                              Zabbix proxy with MySQL database support        10                                      [OK]</span><br><span class="line">centos/mysql-56-centos7                                MySQL 5.6 SQL database server                   7                                       </span><br><span class="line">openshift/mysql-55-centos7                             DEPRECATED: A Centos7 based MySQL v5.5 image…   6                                       </span><br><span class="line">circleci/mysql                                         MySQL is a widely used, open-source relation…   3                                       </span><br><span class="line">frodenas/mysql                                         A Docker Image for MySQL                        3                                       [OK]</span><br><span class="line">dsteinkopf/backup-all-mysql                            backup all DBs in a mysql server                3                                       [OK]</span><br><span class="line">inferlink/landmark-mysql                               landmark-mysql                                  0                                       [OK]</span><br><span class="line">cloudposse/mysql                                       Improved `mysql` service with support for `m…   0                                       [OK]</span><br><span class="line">cloudfoundry/cf-mysql-ci                               Image used in CI of cf-mysql-release            0                                       </span><br><span class="line">openzipkin/zipkin-mysql                                Mirror of https://quay.io/repository/openzip…   0                                       </span><br><span class="line">astronomerio/mysql-sink                                MySQL sink                                      0                                       [OK]</span><br><span class="line">ansibleplaybookbundle/mysql-apb                        An APB which deploys RHSCL MySQL                0                                       [OK]</span><br></pre></td></tr></table></figure><h2 id="2-然后从hub-docker-com或者第三方有加速的docker网站查看mysql镜像版本"><a href="#2-然后从hub-docker-com或者第三方有加速的docker网站查看mysql镜像版本" class="headerlink" title="2.然后从hub.docker.com或者第三方有加速的docker网站查看mysql镜像版本"></a>2.然后从hub.docker.com或者第三方有加速的docker网站查看mysql镜像版本</h2><p><strong><a href="https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.79825aaaVNcsUP&amp;repoId=1239" target="_blank" rel="noopener">阿里mysql docker镜像连接</a></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8.0.3, 8.0, 8 (8.0/Dockerfile)</span><br><span class="line">5.7.20, 5.7, 5, latest (5.7/Dockerfile)</span><br><span class="line">5.6.38, 5.6 (5.6/Dockerfile)</span><br><span class="line">5.5.58, 5.5 (5.5/Dockerfile)</span><br></pre></td></tr></table></figure></p><h2 id="3-我选择5-6-38版本下载"><a href="#3-我选择5-6-38版本下载" class="headerlink" title="3.我选择5.6.38版本下载"></a>3.我选择5.6.38版本下载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.6.38</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker pull mysql:5.6.38</span><br><span class="line">5.6.38: Pulling from library/mysql</span><br><span class="line">f49cf87b52c1: Pull complete </span><br><span class="line">78032de49d65: Pull complete </span><br><span class="line">837546b20bc4: Pull complete </span><br><span class="line">9b8316af6cc6: Pull complete </span><br><span class="line">28dd7bab809d: Pull complete </span><br><span class="line">8b95be8b8d36: Pull complete </span><br><span class="line">67ee8c6f60b5: Pull complete </span><br><span class="line">74616d0d8b72: Pull complete </span><br><span class="line">6246d987d47e: Pull complete </span><br><span class="line">66cd90934fab: Pull complete </span><br><span class="line">Digest: sha256:078c9e0486639831d44c18ec8bc545e20ca74419822387c3eab2ea54a8e71515</span><br><span class="line">Status: Downloaded newer image for mysql:5.6.38</span><br></pre></td></tr></table></figure><h2 id="4-查看本地镜像-可以看到已经在本地仓库"><a href="#4-查看本地镜像-可以看到已经在本地仓库" class="headerlink" title="4.查看本地镜像 可以看到已经在本地仓库"></a>4.查看本地镜像 可以看到已经在本地仓库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker images</span><br><span class="line">REPOSITORY                                     TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mysql                                          5.6.38              15a5ee56ec55        6 weeks ago         299MB</span><br></pre></td></tr></table></figure><h2 id="5-开启mysql一个容器-就是我们平常所说的实例"><a href="#5-开启mysql一个容器-就是我们平常所说的实例" class="headerlink" title="5.开启mysql一个容器(就是我们平常所说的实例)"></a>5.开启mysql一个容器(就是我们平常所说的实例)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql5.6.38 -e MYSQL_ROOT_PASSWORD=root -d -p 3306:3306 mysql:5.6.38</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-e MYSQL_ROOT_PASSWORD=root 初始化密码</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker run --name mysql5.6.38 -e MYSQL_ROOT_PASSWORD=root -d -p 3306:3306 mysql:5.6.38</span><br><span class="line">1794aed7cfe17c7a8df7c1403a25feaecced3ccbef3844c9240bb0c8e27c2b85</span><br><span class="line"></span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">1794aed7cfe1        mysql:5.6.38        &quot;docker-entrypoint.s…&quot;   7 seconds ago       Up 6 seconds        0.0.0.0:3306-&gt;3306/tcp   mysql5.6.38</span><br></pre></td></tr></table></figure><h2 id="6-mysql远程连接"><a href="#6-mysql远程连接" class="headerlink" title="6.mysql远程连接"></a>6.mysql远程连接</h2><p><strong>navicat远程连接mysql容器 –&gt; 外网地址:3306</strong><br><strong>如果是阿里云esc服务器,安全组3306端口要开放</strong></p><h2 id="7-如果是在同一个docker下的容器要连接mysql"><a href="#7-如果是在同一个docker下的容器要连接mysql" class="headerlink" title="7.如果是在同一个docker下的容器要连接mysql"></a>7.如果是在同一个docker下的容器要连接mysql</h2><p><strong>7.1别名访问</strong><br><strong>比如tomcat连接mysql,那tomcat的启动参数里要加–link连接</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name tomcat重新命名 --link mysql5.6.38:别名 -d tomcat仓库名</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在tomcat容器里的mysql连接地址就写为:别名</span><br><span class="line">比如：jdbc:mysql://192.168.123.123:3306</span><br><span class="line">就写为:jdbc:mysql://别名:3306</span><br></pre></td></tr></table></figure><p><strong>7.2内网ip访问</strong><br><strong>获取mysql容器内网ip地址</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; mysql5.6.38</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">432bd371973f        tomcat:8.5.24       &quot;catalina.sh run&quot;        12 minutes ago      Up 12 minutes       0.0.0.0:8080-&gt;8080/tcp   tomcat8.5.24</span><br><span class="line">1794aed7cfe1        mysql:5.6.38        &quot;docker-entrypoint.s…&quot;   3 hours ago         Up About an hour    0.0.0.0:3306-&gt;3306/tcp   mysql5.6.38</span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; mysql5.6.38</span><br><span class="line">172.17.0.2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在tomcat容器里的mysql连接地址就写为:内网ip</span><br><span class="line">比如：jdbc:mysql://192.168.123.123:3306</span><br><span class="line">jdbc:mysql://172.17.0.2:3306</span><br></pre></td></tr></table></figure><h2 id="8-进入mysql容器"><a href="#8-进入mysql容器" class="headerlink" title="8.进入mysql容器"></a>8.进入mysql容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器id或者容器名字 /bin/bash</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">1794aed7cfe1        mysql:5.6.38        &quot;docker-entrypoint.s…&quot;   29 minutes ago      Up 29 minutes       0.0.0.0:3306-&gt;3306/tcp   mysql5.6.38</span><br><span class="line"></span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker exec -it 1794aed7cfe1 /bin/bash</span><br><span class="line">root@1794aed7cfe1:/#</span><br></pre></td></tr></table></figure><h2 id="拿到shell-收工"><a href="#拿到shell-收工" class="headerlink" title="拿到shell,收工"></a>拿到shell,收工</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;参考：&lt;a href=&quot;https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.79825aaaVNcsUP&amp;amp;repoId=1239&quot; target=&quot;_blank&quot; rel=&quot;noopener
      
    
    </summary>
    
      <category term="Docker" scheme="http://code.cookily.cn/categories/Docker/"/>
    
      <category term="MySQL" scheme="http://code.cookily.cn/categories/Docker/MySQL/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Docker/MySQL/Centos-7/"/>
    
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Docker" scheme="http://code.cookily.cn/tags/Docker/"/>
    
      <category term="MySQL" scheme="http://code.cookily.cn/tags/MySQL/"/>
    
      <category term="内部连接" scheme="http://code.cookily.cn/tags/%E5%86%85%E9%83%A8%E8%BF%9E%E6%8E%A5/"/>
    
      <category term="外部连接" scheme="http://code.cookily.cn/tags/%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5/"/>
    
  </entry>
  
  <entry>
    <title>Centos7 Nginx 安装</title>
    <link href="http://code.cookily.cn/2018/02/26/qwertyu/"/>
    <id>http://code.cookily.cn/2018/02/26/qwertyu/</id>
    <published>2018-02-26T08:01:25.542Z</published>
    <updated>2018-02-26T08:01:25.543Z</updated>
    
    <content type="html"><![CDATA[<p><strong>我使用centos7X64最小化安装</strong><br><strong>CentOS-7-x86_64-Minimal-1708</strong></p><h2 id="1-关闭firewall："><a href="#1-关闭firewall：" class="headerlink" title="1.关闭firewall："></a>1.关闭firewall：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service #停止firewall</span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br><span class="line">firewall-cmd --state #查看默认防火墙状态（关闭后显示notrunning，开启后显示running）</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --state</span><br><span class="line">not running</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></table></figure><h2 id="2-安装wget"><a href="#2-安装wget" class="headerlink" title="2.安装wget"></a>2.安装wget</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br></pre></td></tr></table></figure><h2 id="3-安装nginx-编译环境"><a href="#3-安装nginx-编译环境" class="headerlink" title="3.安装nginx 编译环境"></a>3.安装nginx 编译环境</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc-c++</span><br><span class="line">yum install -y pcre pcre-devel</span><br><span class="line">yum install -y zlib zlib-devel</span><br><span class="line">yum install -y openssl openssl-devel</span><br></pre></td></tr></table></figure><h2 id="4-安装nginx"><a href="#4-安装nginx" class="headerlink" title="4.安装nginx"></a>4.安装nginx</h2><p><strong>官方查看最新稳定版本  <a href="https://nginx.org/en/download.html" target="_blank" rel="noopener">官网链接直达</a></strong><br><strong>我现在最新稳定版本是:nginx-1.12.2</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://nginx.org/download/nginx-1.12.2.tar.gz</span><br></pre></td></tr></table></figure><h2 id="5-解压"><a href="#5-解压" class="headerlink" title="5.解压"></a>5.解压</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf nginx-1.12.2.tar.gz</span><br><span class="line">cd nginx-1.12.2</span><br></pre></td></tr></table></figure><h2 id="6-配置nginx"><a href="#6-配置nginx" class="headerlink" title="6.配置nginx"></a>6.配置nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br></pre></td></tr></table></figure><h2 id="7-编译安装"><a href="#7-编译安装" class="headerlink" title="7.编译安装"></a>7.编译安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="8-启动、停止、重启nginx"><a href="#8-启动、停止、重启nginx" class="headerlink" title="8.启动、停止、重启nginx"></a>8.启动、停止、重启nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/sbin/</span><br><span class="line">./nginx </span><br><span class="line">./nginx -s reload #重新加载配置文件</span><br><span class="line">./nginx -s quit #:推荐 待nginx进程处理任务完毕进行停止</span><br><span class="line">./nginx -s stop #:先查出nginx进程id再使用kill命令强制杀掉进程。</span><br></pre></td></tr></table></figure><h2 id="9-查询nginx进程："><a href="#9-查询nginx进程：" class="headerlink" title="9.查询nginx进程："></a>9.查询nginx进程：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux|grep nginx</span><br></pre></td></tr></table></figure><h2 id="10-开机自启动"><a href="#10-开机自启动" class="headerlink" title="10.开机自启动"></a>10.开机自启动</h2><p><strong>在rc.local增加启动代码就可以了。</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.local</span><br></pre></td></tr></table></figure><p><strong>底部增加一行:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure></p><p><strong>设置执行权限：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 /etc/rc.local</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;我使用centos7X64最小化安装&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;CentOS-7-x86_64-Minimal-1708&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-关闭firewall：&quot;&gt;&lt;a href=&quot;#1-关闭firewall：&quot; 
      
    
    </summary>
    
      <category term="Nginx" scheme="http://code.cookily.cn/categories/Nginx/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Nginx/Centos-7/"/>
    
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Nginx" scheme="http://code.cookily.cn/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>Centos7 安装  jdk8</title>
    <link href="http://code.cookily.cn/2018/02/26/sdfsf/"/>
    <id>http://code.cookily.cn/2018/02/26/sdfsf/</id>
    <published>2018-02-26T08:01:25.503Z</published>
    <updated>2018-02-26T08:01:25.503Z</updated>
    
    <content type="html"><![CDATA[<p><strong>我使用centos7X64最小化安装</strong><br><strong>CentOS-7-x86_64-Minimal-1708</strong></p><h2 id="1-安装wget"><a href="#1-安装wget" class="headerlink" title="1.安装wget"></a>1.安装wget</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br></pre></td></tr></table></figure><h2 id="2-下载jdk8"><a href="#2-下载jdk8" class="headerlink" title="2.下载jdk8"></a>2.下载jdk8</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.oracle.com/otn-pub/java/jdk/8u151-b12/e758a0de34e24606bca991d704f6dcbf/jdk-8u151-linux-x64.tar.gz?AuthParam=1515389081_199e6be1d23489a50e55e6979e5f31c9</span><br></pre></td></tr></table></figure><p><strong>若失效，官网自己查下载地址</strong></p><h2 id="3-解压"><a href="#3-解压" class="headerlink" title="3.解压"></a>3.解压</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u151-linux-x64.tar.gz?AuthParam=1515389081_199e6be1d23489a50e55e6979e5f31c9</span><br></pre></td></tr></table></figure><h2 id="4-移动到-usr-local-java-jdk1-8-0-151"><a href="#4-移动到-usr-local-java-jdk1-8-0-151" class="headerlink" title="4.移动到/usr/local/java/jdk1.8.0_151"></a>4.移动到/usr/local/java/jdk1.8.0_151</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/java</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv jdk1.8.0_151/ /usr/local/java/jdk1.8.0_151</span><br></pre></td></tr></table></figure><h2 id="5-设置环境变量"><a href="#5-设置环境变量" class="headerlink" title="5.设置环境变量"></a>5.设置环境变量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure><h3 id="文件最后加入："><a href="#文件最后加入：" class="headerlink" title="文件最后加入："></a>文件最后加入：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/java/jdk1.8.0_151</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure><h2 id="6-配置文件立即生效"><a href="#6-配置文件立即生效" class="headerlink" title="6.配置文件立即生效"></a>6.配置文件立即生效</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h2 id="7-查看是否安装成功"><a href="#7-查看是否安装成功" class="headerlink" title="7.查看是否安装成功"></a>7.查看是否安装成功</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;我使用centos7X64最小化安装&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;CentOS-7-x86_64-Minimal-1708&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-安装wget&quot;&gt;&lt;a href=&quot;#1-安装wget&quot; class=&quot;hea
      
    
    </summary>
    
      <category term="JDK8" scheme="http://code.cookily.cn/categories/JDK8/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/JDK8/Centos-7/"/>
    
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="JDK8" scheme="http://code.cookily.cn/tags/JDK8/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 下 docker 安装 tomcat 和 使用</title>
    <link href="http://code.cookily.cn/2018/02/26/qwer/"/>
    <id>http://code.cookily.cn/2018/02/26/qwer/</id>
    <published>2018-02-26T08:01:25.459Z</published>
    <updated>2018-02-26T08:01:25.460Z</updated>
    
    <content type="html"><![CDATA[<p><strong>参考：<a href="https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.2hEAlq&amp;repoId=1270" target="_blank" rel="noopener">阿里云tomcat docker 文档</a></strong></p><h2 id="1-首先查看下仓库镜像"><a href="#1-首先查看下仓库镜像" class="headerlink" title="1.首先查看下仓库镜像"></a>1.首先查看下仓库镜像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search tomcat</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker search tomcat</span><br><span class="line">NAME                                  DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">tomcat                                Apache Tomcat is an open source implementati…   1710                [OK]                </span><br><span class="line">dordoka/tomcat                        Ubuntu 14.04, Oracle JDK 8 and Tomcat 8 base…   47                                      [OK]</span><br><span class="line">tomee                                 Apache TomEE is an all-Apache Java EE certif…   44                  [OK]                </span><br><span class="line">davidcaste/alpine-tomcat              Apache Tomcat 7/8 using Oracle Java 7/8 with…   24                                      [OK]</span><br><span class="line">consol/tomcat-7.0                     Tomcat 7.0.57, 8080, &quot;admin/admin&quot;              17                                      [OK]</span><br><span class="line">cloudesire/tomcat                     Tomcat server, 6/7/8                            15                                      [OK]</span><br><span class="line">bitnami/tomcat                        Bitnami Tomcat Docker Image                     10                                      [OK]</span><br><span class="line">meirwa/spring-boot-tomcat-mysql-app   a sample spring-boot app using tomcat and My…   8                                       [OK]</span><br><span class="line">tutum/tomcat                          Base docker image to run a Tomcat applicatio…   8                                       </span><br><span class="line">jeanblanchard/tomcat                  Minimal Docker image with Apache Tomcat         8                                       </span><br><span class="line">aallam/tomcat-mysql                   Debian, Oracle JDK, Tomcat &amp; MySQL              6                                       [OK]</span><br><span class="line">maluuba/tomcat7-java8                 Tomcat7 with java8.                             1                                       </span><br><span class="line">99taxis/tomcat7                       Tomcat7                                         1                                       [OK]</span><br><span class="line">primetoninc/tomcat                    Apache tomcat 8.5, 8.0, 7.0                     1                                       [OK]</span><br><span class="line">picoded/tomcat7                       tomcat7 with jre8 and MANAGER_USER / MANAGER…   0                                       [OK]</span><br><span class="line">oobsri/tomcat8                        Testing CI Jobs with different names.           0                                       </span><br><span class="line">s390x/tomcat                          Apache Tomcat is an open source implementati…   0                                       </span><br><span class="line">fabric8/tomcat-8                      Fabric8 Tomcat 8 Image                          0                                       [OK]</span><br><span class="line">trollin/tomcat                                                                        0                                       </span><br><span class="line">awscory/tomcat                        tomcat                                          0                                       </span><br><span class="line">swisstopo/service-print-tomcat        backend tomcat for service-print &quot;the true, …   0                                       </span><br><span class="line">qminderapp/tomcat7                    Tomcat 7                                        0                                       </span><br><span class="line">hegand/tomcat                         docker-tomcat                                   0                                       [OK]</span><br><span class="line">buravelli9/tomcat-az-standards        Tomcat image-AZ                                 0</span><br></pre></td></tr></table></figure><h2 id="2-然后从hub-docker-com或者第三方有加速的docker网站查看tomcat镜像版本"><a href="#2-然后从hub-docker-com或者第三方有加速的docker网站查看tomcat镜像版本" class="headerlink" title="2.然后从hub.docker.com或者第三方有加速的docker网站查看tomcat镜像版本"></a>2.然后从hub.docker.com或者第三方有加速的docker网站查看tomcat镜像版本</h2><p><strong><a href="https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.2hEAlq&amp;repoId=1270" target="_blank" rel="noopener">阿里云tomcat docker镜像连接</a></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7.0.82-jre7, 7.0-jre7, 7-jre7, 7.0.82, 7.0, 7 (7/jre7/Dockerfile)</span><br><span class="line">7.0.82-jre7-alpine, 7.0-jre7-alpine, 7-jre7-alpine, 7.0.82-alpine, 7.0-alpine, 7-alpine (7/jre7-alpine/Dockerfile)</span><br><span class="line">7.0.82-jre8, 7.0-jre8, 7-jre8 (7/jre8/Dockerfile)</span><br><span class="line">7.0.82-jre8-alpine, 7.0-jre8-alpine, 7-jre8-alpine (7/jre8-alpine/Dockerfile)</span><br><span class="line">8.0.47-jre7, 8.0-jre7, 8.0.47, 8.0 (8.0/jre7/Dockerfile)</span><br><span class="line">8.0.47-jre7-alpine, 8.0-jre7-alpine, 8.0.47-alpine, 8.0-alpine (8.0/jre7-alpine/Dockerfile)</span><br><span class="line">8.0.47-jre8, 8.0-jre8 (8.0/jre8/Dockerfile)</span><br><span class="line">8.0.47-jre8-alpine, 8.0-jre8-alpine (8.0/jre8-alpine/Dockerfile)</span><br><span class="line">8.5.24-jre8, 8.5-jre8, 8-jre8, jre8, 8.5.24, 8.5, 8, latest (8.5/jre8/Dockerfile)</span><br><span class="line">8.5.24-jre8-alpine, 8.5-jre8-alpine, 8-jre8-alpine, jre8-alpine, 8.5.24-alpine, 8.5-alpine, 8-alpine, alpine (8.5/jre8-alpine/Dockerfile)</span><br><span class="line">9.0.2-jre8, 9.0-jre8, 9-jre8, 9.0.2, 9.0, 9 (9.0/jre8/Dockerfile)</span><br><span class="line">9.0.2-jre8-alpine, 9.0-jre8-alpine, 9-jre8-alpine, 9.0.2-alpine, 9.0-alpine, 9-alpine (9.0/jre8-alpine/Dockerfile)</span><br></pre></td></tr></table></figure></p><h2 id="3-我选择8-5-24版本下载"><a href="#3-我选择8-5-24版本下载" class="headerlink" title="3.我选择8.5.24版本下载"></a>3.我选择8.5.24版本下载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat:8.5.24</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker pull tomcat:8.5.24</span><br><span class="line">8.5.24: Pulling from library/tomcat</span><br><span class="line">723254a2c089: Pull complete </span><br><span class="line">abe15a44e12f: Pull complete </span><br><span class="line">409a28e3cc3d: Pull complete </span><br><span class="line">a9511c68044a: Pull complete </span><br><span class="line">9d1b16e30bc8: Pull complete </span><br><span class="line">0fc5a09c9242: Pull complete </span><br><span class="line">d34976006493: Pull complete </span><br><span class="line">3b70003f0c10: Pull complete </span><br><span class="line">bc7887582e2e: Pull complete </span><br><span class="line">d2ab4f165865: Pull complete </span><br><span class="line">f671595c8b4b: Pull complete </span><br><span class="line">cc8cdb15e511: Pull complete </span><br><span class="line">Digest: sha256:e39e0a3982b6de106d95b4e06d6e94fdc5ec7d6cadf310f7fae02e4e182cd830</span><br><span class="line">Status: Downloaded newer image for tomcat:8.5.24</span><br></pre></td></tr></table></figure><h2 id="4-查看本地镜像-可以看到已经在本地仓库"><a href="#4-查看本地镜像-可以看到已经在本地仓库" class="headerlink" title="4.查看本地镜像 可以看到已经在本地仓库"></a>4.查看本地镜像 可以看到已经在本地仓库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker images</span><br><span class="line">REPOSITORY                                     TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">tomcat                                         8.5.24              66bbed06c8cd        2 weeks ago         557MB</span><br></pre></td></tr></table></figure><h2 id="5-开启tomcat一个容器-就是我们平常所说的实例"><a href="#5-开启tomcat一个容器-就是我们平常所说的实例" class="headerlink" title="5.开启tomcat一个容器(就是我们平常所说的实例)"></a>5.开启tomcat一个容器(就是我们平常所说的实例)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name tomcat8.5.24 -d -p 8080:8080 tomcat:8.5.24</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker run --name tomcat8.5.24 -d -p 8080:8080 tomcat:8.5.24</span><br><span class="line">432bd371973ffb651083142f79913b675a8c400a7d011e7a5d3b4f70817f25b2</span><br><span class="line"></span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">432bd371973f        tomcat:8.5.24       &quot;catalina.sh run&quot;        56 seconds ago      Up 54 seconds       0.0.0.0:8080-&gt;8080/tcp   tomcat8.5.24</span><br></pre></td></tr></table></figure><h2 id="6-tomcat远程访问"><a href="#6-tomcat远程访问" class="headerlink" title="6.tomcat远程访问"></a>6.tomcat远程访问</h2><p><strong>外网地址:8080</strong><br><strong>如果是阿里云esc服务器,安全组8080端口要开放</strong></p><h2 id="7-如果是在同一个docker下的容器要连接tomcat"><a href="#7-如果是在同一个docker下的容器要连接tomcat" class="headerlink" title="7.如果是在同一个docker下的容器要连接tomcat"></a>7.如果是在同一个docker下的容器要连接tomcat</h2><p><strong>7.1别名访问</strong><br><strong>比如tomcat2连接tomcat,那tomcat2的启动参数里要加–link连接</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name tomcat2重新命名 --link tomcat:别名 -d tomcat2仓库名</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在tomcat2容器里的tomcat连接地址就写为--&gt;别名:8080</span><br><span class="line">比如：http://192.168.123.123:8080</span><br><span class="line">就写为:http://别名:8080</span><br></pre></td></tr></table></figure><p><strong>7.2内网ip访问</strong><br><strong>获取tomcat容器内网ip地址</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; tomcat8.5.24</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">432bd371973f        tomcat:8.5.24       &quot;catalina.sh run&quot;        12 minutes ago      Up 12 minutes       0.0.0.0:8080-&gt;8080/tcp   tomcat8.5.24</span><br><span class="line">1794aed7cfe1        mysql:5.6.38        &quot;docker-entrypoint.s…&quot;   3 hours ago         Up About an hour    0.0.0.0:3306-&gt;3306/tcp   mysql5.6.38</span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; tomcat8.5.24</span><br><span class="line">172.17.0.3</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在tomcat容器里的mysql连接地址就写为:内网ip</span><br><span class="line">比如：jdbc:mysql://192.168.123.123:3306</span><br><span class="line">jdbc:mysql://172.17.0.3:3306</span><br></pre></td></tr></table></figure><h2 id="8-进入tomcat容器"><a href="#8-进入tomcat容器" class="headerlink" title="8.进入tomcat容器"></a>8.进入tomcat容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器名字或者id /bin/bash</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ0p61por0uylmZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">432bd371973f        tomcat:8.5.24       &quot;catalina.sh run&quot;        38 minutes ago      Up 38 minutes       0.0.0.0:8080-&gt;8080/tcp   tomcat8.5.24</span><br><span class="line"></span><br><span class="line">[root@iZ0p61por0uylmZ ~]# docker exec -it 432bd371973f /bin/bash</span><br><span class="line">root@432bd371973f:/usr/local/tomcat#</span><br></pre></td></tr></table></figure><h2 id="拿到shell-收工"><a href="#拿到shell-收工" class="headerlink" title="拿到shell,收工"></a>拿到shell,收工</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;参考：&lt;a href=&quot;https://dev.aliyun.com/detail.html?spm=5176.1972343.2.2.2hEAlq&amp;amp;repoId=1270&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;阿里云tom
      
    
    </summary>
    
      <category term="Docker" scheme="http://code.cookily.cn/categories/Docker/"/>
    
      <category term="Tomcat" scheme="http://code.cookily.cn/categories/Docker/Tomcat/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Docker/Tomcat/Centos-7/"/>
    
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Docker" scheme="http://code.cookily.cn/tags/Docker/"/>
    
      <category term="Tomcat，Centos 7" scheme="http://code.cookily.cn/tags/Tomcat%EF%BC%8CCentos-7/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 下安装 Docker-compose</title>
    <link href="http://code.cookily.cn/2018/02/26/qazs/"/>
    <id>http://code.cookily.cn/2018/02/26/qazs/</id>
    <published>2018-02-26T08:01:25.420Z</published>
    <updated>2018-02-26T08:01:25.421Z</updated>
    
    <content type="html"><![CDATA[<p><strong>系统:Centos 7 64bit</strong></p><p><strong>PIP 安装 docker-compose 要先安装python-pip包，所以我们先安装装python-pip</strong></p><h2 id="1、首先检查linux有没有安装python-pip包，直接执行"><a href="#1、首先检查linux有没有安装python-pip包，直接执行" class="headerlink" title="1、首先检查linux有没有安装python-pip包，直接执行"></a>1、首先检查linux有没有安装python-pip包，直接执行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install python-pip</span><br></pre></td></tr></table></figure><h2 id="2、没有python-pip包就执行命令"><a href="#2、没有python-pip包就执行命令" class="headerlink" title="2、没有python-pip包就执行命令"></a>2、没有python-pip包就执行命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install epel-release</span><br></pre></td></tr></table></figure><h2 id="3、执行成功之后，再次执行"><a href="#3、执行成功之后，再次执行" class="headerlink" title="3、执行成功之后，再次执行"></a>3、执行成功之后，再次执行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install python-pip</span><br></pre></td></tr></table></figure><h2 id="4、对安装好的pip进行升级"><a href="#4、对安装好的pip进行升级" class="headerlink" title="4、对安装好的pip进行升级"></a>4、对安装好的pip进行升级</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pip</span><br></pre></td></tr></table></figure><h2 id="5、安装docker-compose命令"><a href="#5、安装docker-compose命令" class="headerlink" title="5、安装docker-compose命令"></a>5、安装docker-compose命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U docker-compose</span><br></pre></td></tr></table></figure><h2 id="6、安装成功后，可以查看-docker-compose-命令的用法"><a href="#6、安装成功后，可以查看-docker-compose-命令的用法" class="headerlink" title="6、安装成功后，可以查看 docker-compose 命令的用法"></a>6、安装成功后，可以查看 docker-compose 命令的用法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -h</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[root@docker2 haproxy]# docker-compose -h</span><br><span class="line">Define and run multi-container applications with Docker.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  docker-compose [-f &lt;arg&gt;...] [options] [COMMAND] [ARGS...]</span><br><span class="line">  docker-compose -h|--help</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -f, --file FILE             Specify an alternate compose file (default: docker-compose.yml)</span><br><span class="line">  -p, --project-name NAME     Specify an alternate project name (default: directory name)</span><br><span class="line">  --verbose                   Show more output</span><br><span class="line">  --no-ansi                   Do not print ANSI control characters</span><br><span class="line">  -v, --version               Print version and exit</span><br><span class="line">  -H, --host HOST             Daemon socket to connect to</span><br><span class="line"></span><br><span class="line">  --tls                       Use TLS; implied by --tlsverify</span><br><span class="line">  --tlscacert CA_PATH         Trust certs signed only by this CA</span><br><span class="line">  --tlscert CLIENT_CERT_PATH  Path to TLS certificate file</span><br><span class="line">  --tlskey TLS_KEY_PATH       Path to TLS key file</span><br><span class="line">  --tlsverify                 Use TLS and verify the remote</span><br><span class="line">  --skip-hostname-check       Don&apos;t check the daemon&apos;s hostname against the name specified</span><br><span class="line">                              in the client certificate (for example if your docker host</span><br><span class="line">                              is an IP address)</span><br><span class="line">  --project-directory PATH    Specify an alternate working directory</span><br><span class="line">                              (default: the path of the Compose file)</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  build              Build or rebuild services</span><br><span class="line">  bundle             Generate a Docker bundle from the Compose file</span><br><span class="line">  config             Validate and view the Compose file</span><br><span class="line">  create             Create services</span><br><span class="line">  down               Stop and remove containers, networks, images, and volumes</span><br><span class="line">  events             Receive real time events from containers</span><br><span class="line">  exec               Execute a command in a running container</span><br><span class="line">  help               Get help on a command</span><br><span class="line">  images             List images</span><br><span class="line">  kill               Kill containers</span><br><span class="line">  logs               View output from containers</span><br><span class="line">  pause              Pause services</span><br><span class="line">  port               Print the public port for a port binding</span><br><span class="line">  ps                 List containers</span><br><span class="line">  pull               Pull service images</span><br><span class="line">  push               Push service images</span><br><span class="line">  restart            Restart services</span><br><span class="line">  rm                 Remove stopped containers</span><br><span class="line">  run                Run a one-off command</span><br><span class="line">  scale              Set number of containers for a service</span><br><span class="line">  start              Start services</span><br><span class="line">  stop               Stop services</span><br><span class="line">  top                Display the running processes</span><br><span class="line">  unpause            Unpause services</span><br><span class="line">  up                 Create and start containers</span><br><span class="line">  version            Show the Docker-Compose version information</span><br></pre></td></tr></table></figure><h2 id="7、可以添加-bash-补全命令"><a href="#7、可以添加-bash-补全命令" class="headerlink" title="7、可以添加 bash 补全命令"></a>7、可以添加 bash 补全命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://raw.githubusercontent.com/docker/compose/1.2.0/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;系统:Centos 7 64bit&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PIP 安装 docker-compose 要先安装python-pip包，所以我们先安装装python-pip&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;1、首先检查lin
      
    
    </summary>
    
      <category term="Docker" scheme="http://code.cookily.cn/categories/Docker/"/>
    
      <category term="Docker-compose" scheme="http://code.cookily.cn/categories/Docker/Docker-compose/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Docker/Docker-compose/Centos-7/"/>
    
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Docker，Centos 7" scheme="http://code.cookily.cn/tags/Docker%EF%BC%8CCentos-7/"/>
    
      <category term="Docker-compose" scheme="http://code.cookily.cn/tags/Docker-compose/"/>
    
  </entry>
  
  <entry>
    <title>Centos7 Keepalived+Nginx 热备</title>
    <link href="http://code.cookily.cn/2018/02/26/qwert/"/>
    <id>http://code.cookily.cn/2018/02/26/qwert/</id>
    <published>2018-02-26T08:01:25.372Z</published>
    <updated>2018-02-26T08:01:25.373Z</updated>
    
    <content type="html"><![CDATA[<p><strong>我使用centos7X64最小化安装</strong><br><strong>CentOS-7-x86_64-Minimal-1708</strong></p><p><strong>准备：两台机子，三个ip(能互通{一般同一个网段})</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx_01 ip:192.168.59.128 主机</span><br><span class="line">nginx_02 ip:192.168.59.129 从机</span><br><span class="line">漂浮ip：192.168.59.130</span><br></pre></td></tr></table></figure></p><h2 id="1-关闭firewall："><a href="#1-关闭firewall：" class="headerlink" title="1.关闭firewall："></a>1.关闭firewall：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service #停止firewall</span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br><span class="line">firewall-cmd --state #查看默认防火墙状态（关闭后显示notrunning，开启后显示running）</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --state</span><br><span class="line">not running</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></table></figure><h2 id="2、安装keepalived"><a href="#2、安装keepalived" class="headerlink" title="2、安装keepalived"></a>2、安装keepalived</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install keepalived</span><br><span class="line">keepalived -v</span><br></pre></td></tr></table></figure><h2 id="3-先备份配置文件"><a href="#3-先备份配置文件" class="headerlink" title="3.先备份配置文件"></a>3.先备份配置文件</h2><p><strong>在nginx_01上配置</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/keepalived/keepalived.conf /etc/keepalived/keepalived.conf.bak</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/keepalived/keepalived.conf</span><br></pre></td></tr></table></figure><p><strong>修改成如下内容</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File for keepalived</span><br><span class="line">global_defs &#123;</span><br><span class="line">    router_id nginx_server_1</span><br><span class="line">&#125;</span><br><span class="line">vrrp_script chk_nginx &#123;</span><br><span class="line">    script &quot;/etc/keepalived/nginx_check.sh&quot;</span><br><span class="line">    interval 2</span><br><span class="line">    weight 20</span><br><span class="line">    !weight为正数</span><br><span class="line">    !如果脚本执行结果为0,,Master:weight+priority&gt;Backup:weight+priority(不切换)</span><br><span class="line">    !如果脚本执行结果不为0,Master:priority&lt;Backup:priority+weight(切换)</span><br><span class="line">    !weight为负数</span><br><span class="line">    !如果脚本执行结果为0,,Master:priority&gt;Backup:priority(不切换)</span><br><span class="line">    !如果脚本执行结果不为0,Master:priority+weight&lt;Backup:priority(切换)</span><br><span class="line">    !一般来说,weight的绝对值要大于Master和Backup的priority之差</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface ens33 !网卡接口地址</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    mcast_src_ip 192.168.59.128 !nginx01 ip</span><br><span class="line">    priority 100</span><br><span class="line">    nopreempt</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111 !认密码 两台nginx密码要一致</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        chk_nginx</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.59.222/24 !漂浮ip 可以有多个 回车隔开</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>在nginx_02上配置</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/keepalived/keepalived.conf /etc/keepalived/keepalived.conf.bak</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/keepalived/keepalived.conf</span><br></pre></td></tr></table></figure><p><strong>修改成如下内容</strong></p><p><strong>注意:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">state 和主不一样，是BACKUP</span><br><span class="line">route_id 和主不一样</span><br><span class="line">priority 小于主机</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File for keepalived</span><br><span class="line">global_defs &#123;</span><br><span class="line">    router_id nginx_server_2</span><br><span class="line">&#125;</span><br><span class="line">vrrp_script chk_nginx &#123;</span><br><span class="line">    script &quot;/etc/keepalived/nginx_check.sh&quot;</span><br><span class="line">    interval 2</span><br><span class="line">    weight 20</span><br><span class="line">    !weight为正数</span><br><span class="line">    !如果脚本执行结果为0,,Master:weight+priority&gt;Backup:weight+priority(不切换)</span><br><span class="line">    !如果脚本执行结果不为0,Master:priority&lt;Backup:priority+weight(切换)</span><br><span class="line">    !weight为负数</span><br><span class="line">    !如果脚本执行结果为0,,Master:priority&gt;Backup:priority(不切换)</span><br><span class="line">    !如果脚本执行结果不为0,Master:priority+weight&lt;Backup:priority(切换)</span><br><span class="line">    !一般来说,weight的绝对值要大于Master和Backup的priority之差</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface ens33</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    mcast_src_ip 192.168.59.129</span><br><span class="line">    priority 90</span><br><span class="line">    nopreempt</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        chk_nginx</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.59.222/24</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-检查nginx进程的代码-当nginx进程奔溃后，keepalived自动启动nginx"><a href="#4-检查nginx进程的代码-当nginx进程奔溃后，keepalived自动启动nginx" class="headerlink" title="4.检查nginx进程的代码,当nginx进程奔溃后，keepalived自动启动nginx"></a>4.检查nginx进程的代码,当nginx进程奔溃后，keepalived自动启动nginx</h2><p><strong>在nginx_01和nginx_02上都配置一遍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/keepalived/nginx_check.sh</span><br></pre></td></tr></table></figure><p><strong>添加如下代码</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">A=`ps -C nginx --no-header |wc -l`</span><br><span class="line">if [ $A -eq 0 ];then</span><br><span class="line">    /usr/sbin/nginx</span><br><span class="line">    sleep 2</span><br><span class="line">    if [ `ps -C nginx --no-header |wc -l` -eq 0 ];then</span><br><span class="line">        killall keepalived</span><br><span class="line">    fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2 id="5-改成可执行文件"><a href="#5-改成可执行文件" class="headerlink" title="5.改成可执行文件"></a>5.改成可执行文件</h2><p><strong>在nginx_01和nginx_02上都配置一遍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +xxx /etc/keepalived/nginx_check.sh</span><br></pre></td></tr></table></figure><h2 id="6-启动和开机自启动"><a href="#6-启动和开机自启动" class="headerlink" title="6.启动和开机自启动"></a>6.启动和开机自启动</h2><p><strong>在nginx_01和nginx_02上都配置一遍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start keepalived //启动</span><br><span class="line">systemctl enable keepalived //开机自启动</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;我使用centos7X64最小化安装&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;CentOS-7-x86_64-Minimal-1708&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;准备：两台机子，三个ip(能互通{一般同一个网段})&lt;/strong&gt;&lt;b
      
    
    </summary>
    
      <category term="Nginx" scheme="http://code.cookily.cn/categories/Nginx/"/>
    
      <category term="Keepalived" scheme="http://code.cookily.cn/categories/Nginx/Keepalived/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Nginx/Keepalived/Centos-7/"/>
    
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Nginx" scheme="http://code.cookily.cn/tags/Nginx/"/>
    
      <category term="Keepalived" scheme="http://code.cookily.cn/tags/Keepalived/"/>
    
  </entry>
  
  <entry>
    <title>Centos7 安装 Tomcat8</title>
    <link href="http://code.cookily.cn/2018/02/26/dfgsdgsd/"/>
    <id>http://code.cookily.cn/2018/02/26/dfgsdgsd/</id>
    <published>2018-02-26T07:51:25.917Z</published>
    <updated>2018-02-26T07:51:25.918Z</updated>
    
    <content type="html"><![CDATA[<p><strong>我使用centos7X64最小化安装</strong><br><strong>CentOS-7-x86_64-Minimal-1708</strong></p><p><strong>没装jdk的同学，请移步【<a href="http://code.cookily.cn/2018/02/26/Centos7%20%E5%AE%89%E8%A3%85%20%20jdk8/">centos7 安装 jdk8</a>】的文章</strong></p><h2 id="1-关闭firewall："><a href="#1-关闭firewall：" class="headerlink" title="1.关闭firewall："></a>1.关闭firewall：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service #停止firewall</span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br><span class="line">firewall-cmd --state #查看默认防火墙状态（关闭后显示notrunning，开启后显示running）</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --state</span><br><span class="line">not running</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></table></figure><h2 id="2-安装wget"><a href="#2-安装wget" class="headerlink" title="2.安装wget"></a>2.安装wget</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br></pre></td></tr></table></figure><h2 id="3-下载tomcat8"><a href="#3-下载tomcat8" class="headerlink" title="3.下载tomcat8"></a>3.下载tomcat8</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.shuosc.org/apache/tomcat/tomcat-8/v8.5.24/bin/apache-tomcat-8.5.24.tar.gz</span><br></pre></td></tr></table></figure><h2 id="4-解压"><a href="#4-解压" class="headerlink" title="4.解压"></a>4.解压</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-tomcat-8.5.24.tar.gz</span><br></pre></td></tr></table></figure><h2 id="5-移动到-usr-local"><a href="#5-移动到-usr-local" class="headerlink" title="5.移动到/usr/local"></a>5.移动到/usr/local</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv apache-tomcat-8.5.24 /usr/local/tomcat8</span><br></pre></td></tr></table></figure><h2 id="6-配置tomcat的jdk环境变量"><a href="#6-配置tomcat的jdk环境变量" class="headerlink" title="6.配置tomcat的jdk环境变量"></a>6.配置tomcat的jdk环境变量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/tomcat8/conf/catalina.sh</span><br></pre></td></tr></table></figure><p><strong>在 OS specific support. 前面加入如下代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/java/jdk1.8.0_151</span><br><span class="line">JRE_HOME=$JAVA_HOME/jre</span><br></pre></td></tr></table></figure><h2 id="7-配置tomcat8开机启动"><a href="#7-配置tomcat8开机启动" class="headerlink" title="7.配置tomcat8开机启动"></a>7.配置tomcat8开机启动</h2><p><strong>在/usr/lib/systemd/system目录下增加tomcat8.service文件，内容如下:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/lib/systemd/system/tomcat8.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Tomcat</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStart=/usr/local/tomcat8/bin/startup.sh</span><br><span class="line">ExecStop=/usr/local/tomcat8/bin/shutdown.sh</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><h2 id="8-允许tomcat8开机启动"><a href="#8-允许tomcat8开机启动" class="headerlink" title="8.允许tomcat8开机启动"></a>8.允许tomcat8开机启动</h2><p>systemctl enable tomcat8</p><h2 id="9-tomcat8常见命令"><a href="#9-tomcat8常见命令" class="headerlink" title="9.tomcat8常见命令"></a>9.tomcat8常见命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl start tomcat8.service    //启动tomcat</span><br><span class="line"></span><br><span class="line">systemctl stop tomcat8.service    //关闭tomcat   </span><br><span class="line"></span><br><span class="line">systemctl restart tomcat8.service   //重启tomcat </span><br><span class="line"></span><br><span class="line">systemctl status tomcat8.service   //查看状态tomcat</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;我使用centos7X64最小化安装&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;CentOS-7-x86_64-Minimal-1708&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;没装jdk的同学，请移步【&lt;a href=&quot;http://code.coo
      
    
    </summary>
    
      <category term="Tomcat8" scheme="http://code.cookily.cn/categories/Tomcat8/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Tomcat8/Centos-7/"/>
    
    
      <category term="Tomcat8" scheme="http://code.cookily.cn/tags/Tomcat8/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
  </entry>
  
  <entry>
    <title>Centos7 安装 Tomcat8 集群</title>
    <link href="http://code.cookily.cn/2018/02/26/dghfghfdfdgh/"/>
    <id>http://code.cookily.cn/2018/02/26/dghfghfdfdgh/</id>
    <published>2018-02-26T07:49:14.586Z</published>
    <updated>2018-02-26T07:49:14.587Z</updated>
    
    <content type="html"><![CDATA[<p><strong>我使用centos7X64最小化安装</strong><br><strong>CentOS-7-x86_64-Minimal-1708</strong></p><p><strong>没装jdk的同学，请移步【<a href="http://code.cookily.cn/2018/02/26/Centos7%20%E5%AE%89%E8%A3%85%20%20jdk8/">centos7 安装 jdk8</a>】的文章</strong></p><h2 id="1-关闭firewall："><a href="#1-关闭firewall：" class="headerlink" title="1.关闭firewall："></a>1.关闭firewall：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service #停止firewall</span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br><span class="line">firewall-cmd --state #查看默认防火墙状态（关闭后显示notrunning，开启后显示running）</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --state</span><br><span class="line">not running</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></table></figure><h2 id="2-安装wget"><a href="#2-安装wget" class="headerlink" title="2.安装wget"></a>2.安装wget</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget</span><br></pre></td></tr></table></figure><h2 id="3-下载tomcat8"><a href="#3-下载tomcat8" class="headerlink" title="3.下载tomcat8"></a>3.下载tomcat8</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.shuosc.org/apache/tomcat/tomcat-8/v8.5.24/bin/apache-tomcat-8.5.24.tar.gz</span><br></pre></td></tr></table></figure><h2 id="4-解压"><a href="#4-解压" class="headerlink" title="4.解压"></a>4.解压</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-tomcat-8.5.24.tar.gz</span><br></pre></td></tr></table></figure><h2 id="5-移动到-usr-local"><a href="#5-移动到-usr-local" class="headerlink" title="5.移动到/usr/local"></a>5.移动到/usr/local</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv apache-tomcat-8.5.24 /usr/local/tomcat8-node1</span><br></pre></td></tr></table></figure><h2 id="6-配置tomcat的jdk环境变量"><a href="#6-配置tomcat的jdk环境变量" class="headerlink" title="6.配置tomcat的jdk环境变量"></a>6.配置tomcat的jdk环境变量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/tomcat8-node1/conf/catalina.sh</span><br></pre></td></tr></table></figure><p><strong>在 OS specific support. 前面加入如下代码:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/java/jdk1.8.0_151</span><br><span class="line">JRE_HOME=$JAVA_HOME/jre</span><br></pre></td></tr></table></figure><h2 id="7-复制两份tomcat8-node1并重命名为tomcat8-node2，tomcat8-node3"><a href="#7-复制两份tomcat8-node1并重命名为tomcat8-node2，tomcat8-node3" class="headerlink" title="7.复制两份tomcat8-node1并重命名为tomcat8-node2，tomcat8-node3"></a>7.复制两份tomcat8-node1并重命名为tomcat8-node2，tomcat8-node3</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/tomcat8-node1 /usr/local/tomcat8-node2</span><br><span class="line">cp /usr/local/tomcat8-node1 /usr/local/tomcat8-node3</span><br></pre></td></tr></table></figure><h2 id="8-修改tomcat8-node1-tomcat8-node2和tomcat8-node3端口-共三处"><a href="#8-修改tomcat8-node1-tomcat8-node2和tomcat8-node3端口-共三处" class="headerlink" title="8.修改tomcat8-node1,,tomcat8-node2和tomcat8-node3端口,共三处"></a>8.修改tomcat8-node1,,tomcat8-node2和tomcat8-node3端口,共三处</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/tomcat8-node1/conf/server.xml</span><br><span class="line">vi /usr/local/tomcat8-node2/conf/server.xml</span><br><span class="line">vi /usr/local/tomcat8-node3/conf/server.xml</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;</span><br><span class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot; /&gt;</span><br><span class="line">&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;</span><br></pre></td></tr></table></figure><p><strong>习惯上对应改为:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tomcat8-node1: 18005 18080 18009</span><br><span class="line">tomcat8-node2: 28005 28080 28009</span><br><span class="line">tomcat8-node3: 38005 38080 38009</span><br></pre></td></tr></table></figure><h2 id="7-配置tomcat8-node1-tomcat8-node2-tomcat8-node3开机启动"><a href="#7-配置tomcat8-node1-tomcat8-node2-tomcat8-node3开机启动" class="headerlink" title="7.配置tomcat8-node1,tomcat8-node2,tomcat8-node3开机启动"></a>7.配置tomcat8-node1,tomcat8-node2,tomcat8-node3开机启动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在/usr/lib/systemd/system目录下增加tomcat8-node1.service,tomcat8-node2.service,tomcat8-node3.service文件，具体内容如下:</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/lib/systemd/system/tomcat8-node1.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Tomcat</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStart=/usr/local/tomcat8-node1/bin/startup.sh</span><br><span class="line">ExecStop=/usr/local/tomcat8-node1/bin/shutdown.sh</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/lib/systemd/system/tomcat8-node2.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Tomcat</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStart=/usr/local/tomcat8-node2/bin/startup.sh</span><br><span class="line">ExecStop=/usr/local/tomcat8-node2/bin/shutdown.sh</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/lib/systemd/system/tomcat8-node3.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Tomcat</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStart=/usr/local/tomcat8-node3/bin/startup.sh</span><br><span class="line">ExecStop=/usr/local/tomcat8-node3/bin/shutdown.sh</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><h2 id="8-允许tomcat8-node1-tomcat8-node2-tomcat8-node3开机启动"><a href="#8-允许tomcat8-node1-tomcat8-node2-tomcat8-node3开机启动" class="headerlink" title="8.允许tomcat8-node1,tomcat8-node2,tomcat8-node3开机启动"></a>8.允许tomcat8-node1,tomcat8-node2,tomcat8-node3开机启动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable tomcat8-node1</span><br><span class="line">systemctl enable tomcat8-node2</span><br><span class="line">systemctl enable tomcat8-node3</span><br></pre></td></tr></table></figure><h2 id="9-tomcat8常见命令"><a href="#9-tomcat8常见命令" class="headerlink" title="9.tomcat8常见命令"></a>9.tomcat8常见命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl start tomcat8-node1.service    //启动tomcat</span><br><span class="line"></span><br><span class="line">systemctl stop tomcat8-node1.service    //关闭tomcat   </span><br><span class="line"></span><br><span class="line">systemctl restart tomcat8-node1.service   //重启tomcat </span><br><span class="line"></span><br><span class="line">systemctl status tomcat8-node1.service   //查看状态tomcat</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;我使用centos7X64最小化安装&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;CentOS-7-x86_64-Minimal-1708&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;没装jdk的同学，请移步【&lt;a href=&quot;http://code.coo
      
    
    </summary>
    
      <category term="Tomcat8 集群" scheme="http://code.cookily.cn/categories/Tomcat8-%E9%9B%86%E7%BE%A4/"/>
    
      <category term="Centos 7" scheme="http://code.cookily.cn/categories/Tomcat8-%E9%9B%86%E7%BE%A4/Centos-7/"/>
    
    
      <category term="Centos 7" scheme="http://code.cookily.cn/tags/Centos-7/"/>
    
      <category term="Hexo" scheme="http://code.cookily.cn/tags/Hexo/"/>
    
      <category term="IntelliJ IDEA" scheme="http://code.cookily.cn/tags/IntelliJ-IDEA/"/>
    
      <category term="Git" scheme="http://code.cookily.cn/tags/Git/"/>
    
      <category term="Github" scheme="http://code.cookily.cn/tags/Github/"/>
    
      <category term="Node.js" scheme="http://code.cookily.cn/tags/Node-js/"/>
    
      <category term="Tomcat8 集群" scheme="http://code.cookily.cn/tags/Tomcat8-%E9%9B%86%E7%BE%A4/"/>
    
  </entry>
  
</feed>
